<UserControl x:Class="ArcadiaTracker.App.Views.MapView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
             mc:Ignorable="d"
             d:DesignHeight="700" d:DesignWidth="900">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,16">
            <TextBlock Text="Interactive Map" Style="{StaticResource HeaderTextStyle}" Margin="0,0,0,8"/>
            <TextBlock Text="Explore the world - find resources, blueprints, and POIs"
                       Style="{StaticResource SubheaderTextStyle}"/>
        </StackPanel>

        <!-- Quick Navigation Buttons -->
        <Border Grid.Row="1" Style="{StaticResource CardStyle}" Padding="12" Margin="0,0,0,16">
            <StackPanel Orientation="Horizontal">
                <Button Content="ðŸ—ºï¸ Map" Style="{StaticResource PrimaryButtonStyle}"
                        Click="MapButton_Click" Margin="0,0,8,0"/>
                <Button Content="ðŸ“¦ Items" Style="{StaticResource SecondaryButtonStyle}"
                        Click="ItemsButton_Click" Margin="0,0,8,0"/>
                <Button Content="ðŸ—ï¸ Buildings" Style="{StaticResource SecondaryButtonStyle}"
                        Click="BuildingsButton_Click" Margin="0,0,8,0"/>
                <Button Content="ðŸ”¬ Research" Style="{StaticResource SecondaryButtonStyle}"
                        Click="ResearchButton_Click"/>

                <Separator Margin="16,0" Background="{StaticResource SurfaceLightBrush}"/>

                <Button x:Name="RefreshButton" Content="â†» Refresh"
                        Style="{StaticResource SecondaryButtonStyle}"
                        Click="RefreshButton_Click"/>
            </StackPanel>
        </Border>

        <!-- WebView2 Container -->
        <Border Grid.Row="2" CornerRadius="8" ClipToBounds="True"
                Background="{StaticResource SurfaceBrush}">
            <Grid>
                <!-- WebView -->
                <wv2:WebView2 x:Name="WebView"
                              Source="https://starrupture.tools/map"
                              NavigationStarting="WebView_NavigationStarting"
                              NavigationCompleted="WebView_NavigationCompleted"/>

                <!-- Loading Overlay -->
                <Border x:Name="LoadingOverlay"
                        Background="#CC0A0A0F"
                        Visibility="Visible">
                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                        <TextBlock Text="Loading map..."
                                   FontSize="18"
                                   Foreground="{StaticResource PrimaryBrush}"
                                   HorizontalAlignment="Center"/>
                        <ProgressBar IsIndeterminate="True"
                                     Width="200"
                                     Height="4"
                                     Margin="0,16,0,0"
                                     Style="{StaticResource SciFiProgressBar}"/>
                    </StackPanel>
                </Border>

                <!-- Error Overlay -->
                <Border x:Name="ErrorOverlay"
                        Background="{StaticResource SurfaceBrush}"
                        Visibility="Collapsed">
                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                        <TextBlock Text="âš ï¸"
                                   FontSize="48"
                                   HorizontalAlignment="Center"/>
                        <TextBlock x:Name="ErrorMessage"
                                   Text="Failed to load page"
                                   FontSize="16"
                                   Foreground="{StaticResource ErrorBrush}"
                                   HorizontalAlignment="Center"
                                   Margin="0,8,0,0"/>
                        <Button Content="Try Again"
                                Style="{StaticResource PrimaryButtonStyle}"
                                Click="RefreshButton_Click"
                                Margin="0,16,0,0"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>
    </Grid>
</UserControl>
