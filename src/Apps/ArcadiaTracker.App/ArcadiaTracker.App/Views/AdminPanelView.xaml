<UserControl x:Class="ArcadiaTracker.App.Views.AdminPanelView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d"
             d:DesignHeight="900" d:DesignWidth="900">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel>
            <!-- Header -->
            <TextBlock Text="Admin Panel" Style="{StaticResource HeaderTextStyle}" Margin="0,0,0,4"/>

            <!-- Admin Status Banner -->
            <Border x:Name="AdminStatusBanner" CornerRadius="8" Padding="16,12" Margin="0,0,0,16">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel>
                        <TextBlock x:Name="AdminStatusText" FontSize="13" FontWeight="SemiBold"/>
                        <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                            <TextBlock x:Name="AdminScopeText" FontSize="11"
                                       Foreground="{StaticResource TextMutedBrush}"/>
                            <TextBlock x:Name="AdminExpiryText" FontSize="11"
                                       Foreground="{StaticResource TextMutedBrush}" Margin="16,0,0,0"/>
                            <TextBlock x:Name="AdminMethodText" FontSize="11"
                                       Foreground="{StaticResource TextMutedBrush}" Margin="16,0,0,0"/>
                        </StackPanel>
                    </StackPanel>
                    <Button Grid.Column="1" x:Name="RevokeAdminButton"
                            Content="Revoke Admin"
                            Style="{StaticResource SecondaryButtonStyle}"
                            Click="RevokeAdminButton_Click"
                            Visibility="Collapsed"/>
                </Grid>
            </Border>

            <!-- Break-Glass Emergency Access -->
            <Border x:Name="BreakGlassSection" Style="{StaticResource CardStyle}" Margin="0,0,0,16"
                    Visibility="Collapsed">
                <StackPanel>
                    <TextBlock Text="Emergency Admin Access" FontSize="16" FontWeight="SemiBold"
                               Foreground="{StaticResource WarningBrush}" Margin="0,0,0,8"/>
                    <TextBlock Text="Use this only when the admin token has expired and you need emergency access."
                               Foreground="{StaticResource TextSecondaryBrush}" FontSize="12"
                               TextWrapping="Wrap" Margin="0,0,0,16"/>

                    <TextBlock Text="CHALLENGE" FontSize="11"
                               Foreground="{StaticResource TextMutedBrush}" Margin="0,0,0,4"/>
                    <TextBlock x:Name="BreakGlassChallengeText" FontFamily="Consolas" FontSize="18"
                               FontWeight="Bold" Foreground="{StaticResource WarningBrush}"
                               Margin="0,0,0,16"/>

                    <TextBlock Text="RESPONSE (8-char hex code)" FontSize="11"
                               Foreground="{StaticResource TextMutedBrush}" Margin="0,0,0,4"/>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                        <TextBox x:Name="BreakGlassResponseBox" Width="180"
                                 FontFamily="Consolas" FontSize="16"
                                 Background="{StaticResource SurfaceLightBrush}"
                                 Foreground="{StaticResource TextPrimaryBrush}"
                                 BorderBrush="{StaticResource WarningBrush}"
                                 BorderThickness="1" Padding="8,6"
                                 MaxLength="8"
                                 CaretBrush="{StaticResource WarningBrush}"/>
                        <Button x:Name="BreakGlassActivateButton" Content="Activate (4h)"
                                Style="{StaticResource PrimaryButtonStyle}"
                                Click="BreakGlassActivateButton_Click"
                                Margin="12,0,0,0"/>
                    </StackPanel>

                    <Border x:Name="BreakGlassStatusBorder" Padding="12,8" CornerRadius="6"
                            Visibility="Collapsed">
                        <TextBlock x:Name="BreakGlassStatusText" FontSize="12" TextWrapping="Wrap"/>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Code Generator -->
            <Border Style="{StaticResource PremiumCardStyle}" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="Generate Activation Code" FontSize="16" FontWeight="SemiBold"
                               Foreground="{StaticResource AccentGoldBrush}" Margin="0,0,0,16"/>

                    <TextBlock Text="BUNDLE" FontSize="11"
                               Foreground="{StaticResource TextMutedBrush}" Margin="0,0,0,4"/>
                    <ComboBox x:Name="BundleComboBox"
                              SelectedIndex="0"
                              Background="{StaticResource SurfaceBrush}"
                              Foreground="{StaticResource TextPrimaryBrush}"
                              Margin="0,0,0,16">
                        <ComboBoxItem Content="Pro Bundle (Modify + Inspect + Backup + Themes)" Tag="0"/>
                        <ComboBoxItem Content="Save Modifier" Tag="1"/>
                        <ComboBoxItem Content="Save Inspector" Tag="2"/>
                        <ComboBoxItem Content="Backup Manager" Tag="3"/>
                        <ComboBoxItem Content="Theme Customizer" Tag="4"/>
                        <ComboBoxItem Content="Efficiency Optimizer" Tag="5"/>
                        <ComboBoxItem Content="Milestones &amp; Alerts" Tag="6"/>
                        <ComboBoxItem Content="Export Pro" Tag="7"/>
                    </ComboBox>

                    <Button x:Name="GenerateCodeButton" Content="Generate Code"
                            Style="{StaticResource PrimaryButtonStyle}"
                            Click="GenerateCodeButton_Click"
                            HorizontalAlignment="Left"/>

                    <!-- Generated Code Display -->
                    <Border x:Name="GeneratedCodeBorder" Margin="0,16,0,0"
                            Padding="16,12" CornerRadius="8"
                            Background="{StaticResource BackgroundBrush}"
                            Visibility="Collapsed">
                        <StackPanel>
                            <TextBlock Text="GENERATED CODE" FontSize="10"
                                       Foreground="{StaticResource TextMutedBrush}" Margin="0,0,0,4"/>
                            <TextBlock x:Name="GeneratedCodeText"
                                       FontFamily="Consolas" FontSize="22" FontWeight="Bold"
                                       Foreground="{StaticResource AccentGoldBrush}"
                                       TextAlignment="Center"/>
                            <Button x:Name="CopyCodeButton" Content="Copy to Clipboard"
                                    Style="{StaticResource SecondaryButtonStyle}"
                                    Click="CopyCodeButton_Click"
                                    HorizontalAlignment="Center"
                                    Margin="0,12,0,0"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Quick Self-Activate -->
            <Border Style="{StaticResource PremiumCardStyle}" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="Quick Self-Activate" FontSize="16" FontWeight="SemiBold"
                               Foreground="{StaticResource AccentGoldBrush}" Margin="0,0,0,8"/>
                    <TextBlock Text="Generate and immediately activate features on this machine."
                               Foreground="{StaticResource TextSecondaryBrush}" FontSize="12"
                               Margin="0,0,0,16"/>

                    <StackPanel Orientation="Horizontal">
                        <Button x:Name="SelfActivateProButton" Content="Activate Pro Bundle"
                                Style="{StaticResource PrimaryButtonStyle}"
                                Click="SelfActivateProButton_Click"/>
                        <Button x:Name="SelfActivateAllButton" Content="Activate ALL Features"
                                Style="{StaticResource SecondaryButtonStyle}"
                                Click="SelfActivateAllButton_Click"
                                Margin="12,0,0,0"/>
                    </StackPanel>

                    <Border x:Name="SelfActivateStatusBorder" Margin="0,12,0,0"
                            Padding="12,8" CornerRadius="6" Visibility="Collapsed">
                        <TextBlock x:Name="SelfActivateStatusText" FontSize="13" TextWrapping="Wrap"/>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Batch Code Generator -->
            <Border Style="{StaticResource CardStyle}" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="Batch Generate" FontSize="16" FontWeight="SemiBold"
                               Foreground="{StaticResource TextPrimaryBrush}" Margin="0,0,0,12"/>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                        <TextBlock Text="Count:" Foreground="{StaticResource TextSecondaryBrush}"
                                   VerticalAlignment="Center" Margin="0,0,8,0"/>
                        <TextBox x:Name="BatchCountTextBox" Text="5" Width="60"
                                 Background="{StaticResource SurfaceLightBrush}"
                                 Foreground="{StaticResource TextPrimaryBrush}"
                                 BorderBrush="{StaticResource PrimaryBrush}"
                                 BorderThickness="1" Padding="8,4"
                                 CaretBrush="{StaticResource PrimaryBrush}"/>
                        <Button x:Name="BatchGenerateButton" Content="Generate Batch"
                                Style="{StaticResource SecondaryButtonStyle}"
                                Click="BatchGenerateButton_Click"
                                Margin="12,0,0,0"/>
                        <Button x:Name="CopyBatchButton" Content="Copy All"
                                Style="{StaticResource SecondaryButtonStyle}"
                                Click="CopyBatchButton_Click"
                                Margin="12,0,0,0"/>
                    </StackPanel>
                    <TextBox x:Name="BatchCodesTextBox"
                             IsReadOnly="True"
                             FontFamily="Consolas" FontSize="13"
                             Background="{StaticResource BackgroundBrush}"
                             Foreground="{StaticResource TextSecondaryBrush}"
                             BorderThickness="0" Padding="12"
                             MaxHeight="200"
                             TextWrapping="Wrap"
                             VerticalScrollBarVisibility="Auto"
                             Text="Generated codes will appear here..."/>
                </StackPanel>
            </Border>

            <!-- Capability Inspector -->
            <Border Style="{StaticResource CardStyle}" Margin="0,0,0,16">
                <StackPanel>
                    <Grid Margin="0,0,0,12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="Capability Inspector" FontSize="16" FontWeight="SemiBold"
                                   Foreground="{StaticResource TextPrimaryBrush}"/>
                        <Button Grid.Column="1" x:Name="RefreshCapabilitiesButton"
                                Content="Refresh"
                                Style="{StaticResource SecondaryButtonStyle}"
                                Padding="8,4" FontSize="11"
                                Click="RefreshCapabilitiesButton_Click"/>
                    </Grid>
                    <ItemsControl x:Name="CapabilityList">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Margin="0,0,0,4" Padding="10,8" CornerRadius="6"
                                        Background="{StaticResource SurfaceLightBrush}">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <StackPanel>
                                            <TextBlock Text="{Binding Action}" FontSize="13"
                                                       FontWeight="SemiBold"
                                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                                            <TextBlock Text="{Binding ScopeDisplay}" FontSize="10"
                                                       Foreground="{StaticResource TextMutedBrush}"/>
                                        </StackPanel>
                                        <TextBlock Grid.Column="1" Text="{Binding ExpiryDisplay}"
                                                   FontSize="10" VerticalAlignment="Center"
                                                   Foreground="{Binding ExpiryColor}" Margin="12,0"/>
                                        <TextBlock Grid.Column="2" Text="{Binding StatusIcon}"
                                                   FontSize="14" VerticalAlignment="Center"/>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                    <TextBlock x:Name="NoCapabilitiesText"
                               Text="No active capabilities found."
                               Foreground="{StaticResource TextMutedBrush}"
                               HorizontalAlignment="Center" Margin="0,8"
                               Visibility="Collapsed"/>
                </StackPanel>
            </Border>

            <!-- System Diagnostics -->
            <Border Style="{StaticResource CardStyle}" Margin="0,0,0,16">
                <StackPanel>
                    <Grid Margin="0,0,0,12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="System Diagnostics" FontSize="16" FontWeight="SemiBold"
                                   Foreground="{StaticResource TextPrimaryBrush}"/>
                        <Button Grid.Column="1" x:Name="RefreshDiagnosticsButton"
                                Content="Refresh"
                                Style="{StaticResource SecondaryButtonStyle}"
                                Padding="8,4" FontSize="11"
                                Click="RefreshDiagnosticsButton_Click"/>
                    </Grid>
                    <ItemsControl x:Name="DiagnosticsList">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Margin="0,0,0,3" Padding="10,6" CornerRadius="4"
                                        Background="{StaticResource SurfaceLightBrush}">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="200"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding Label}" FontSize="11"
                                                   Foreground="{StaticResource TextMutedBrush}"/>
                                        <TextBlock Grid.Column="1" Text="{Binding Value}"
                                                   FontSize="11" FontFamily="Consolas"
                                                   Foreground="{Binding ValueColor}"/>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>

                    <!-- Entitlement Repair -->
                    <TextBlock Text="REPAIR TOOLS" FontSize="11"
                               Foreground="{StaticResource TextMutedBrush}" Margin="0,16,0,8"/>
                    <StackPanel Orientation="Horizontal">
                        <Button x:Name="PurgeExpiredButton" Content="Purge Expired"
                                Style="{StaticResource SecondaryButtonStyle}"
                                Padding="8,4" FontSize="11"
                                Click="PurgeExpiredButton_Click"/>
                        <Button x:Name="VerifyIntegrityButton" Content="Verify Store Integrity"
                                Style="{StaticResource SecondaryButtonStyle}"
                                Padding="8,4" FontSize="11"
                                Click="VerifyIntegrityButton_Click"
                                Margin="8,0,0,0"/>
                        <Button x:Name="ExportAuditButton" Content="Export Audit Log"
                                Style="{StaticResource SecondaryButtonStyle}"
                                Padding="8,4" FontSize="11"
                                Click="ExportAuditButton_Click"
                                Margin="8,0,0,0"/>
                    </StackPanel>
                    <Border x:Name="RepairStatusBorder" Margin="0,8,0,0"
                            Padding="12,8" CornerRadius="6" Visibility="Collapsed">
                        <TextBlock x:Name="RepairStatusText" FontSize="12" TextWrapping="Wrap"/>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Audit Log Viewer -->
            <Border Style="{StaticResource CardStyle}">
                <StackPanel>
                    <Grid Margin="0,0,0,12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="Recent Audit Log" FontSize="16" FontWeight="SemiBold"
                                   Foreground="{StaticResource TextPrimaryBrush}"/>
                        <Button Grid.Column="1" x:Name="RefreshAuditButton"
                                Content="Refresh"
                                Style="{StaticResource SecondaryButtonStyle}"
                                Padding="8,4" FontSize="11"
                                Click="RefreshAuditButton_Click"/>
                    </Grid>
                    <ItemsControl x:Name="AuditLogList">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Margin="0,0,0,4" Padding="8,6" CornerRadius="4"
                                        Background="{StaticResource SurfaceLightBrush}">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="140"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding TimestampDisplay}" FontSize="10"
                                                   Foreground="{StaticResource TextMutedBrush}"/>
                                        <TextBlock Grid.Column="1" Text="{Binding Detail}" FontSize="11"
                                                   Foreground="{StaticResource TextSecondaryBrush}"
                                                   TextTrimming="CharacterEllipsis"/>
                                        <TextBlock Grid.Column="2" Text="{Binding Outcome}" FontSize="10"
                                                   Foreground="{Binding OutcomeColor}"
                                                   FontWeight="SemiBold" Margin="8,0,0,0"/>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</UserControl>
